import serial

class WriteSerialData:
    def __init__(self, data, comPort, baudRate):
        self.data = data
        self.comPort = comPort
        self.baudRate = baudRate
        self.serialPort = serial.serial(self.comPort, self.baudRate, 1)
        self.lastOutput = ""

    def run(self):
        self.serialPort.open()
        while True:
            try:
                self.writeSerialData()
            except (Exception) as e:
                print(e)

    def writeSerialData(self, message):
        output = "<" + message + ">"
        if output != self.lastOutput:
            try:
                self.serialPort.write(output)
                self.lastOutput = output
            except (Exception) as e:
                print(e)
